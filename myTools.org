# -*- mode: org ; mode:visual-line; -*-

#+TITLE: Productivity 
#+AUTHOR: Rainer M. Krug
#+EMAIL: Rainer@krugs.be

:CONFIG:
#+OPTIONS: ':nil *:t -:t ::t <:t H:3 \n:nil ^:t arch:headline
#+OPTIONS: author:t c:nil creator:comment d:(not LOGBOOK) date:t e:t
#+OPTIONS: email:nil f:t inline:t num:t p:nil pri:nil prop:nil stat:t
#+OPTIONS: tags:t tasks:t tex:t timestamp:t toc:t todo:t |:t
#+CREATOR: Emacs 24.3.1 (Org mode 8.2.1)
#+DESCRIPTION:
#+EXCLUDE_TAGS: noexport
#+KEYWORDS:
#+LANGUAGE: en
#+SELECT_TAGS: export
#+DRAWERS: HIDDEN PROPERTIES STATE CONFIG BABEL OUTPUT LATEXHEADER HTMLHEADER VARIABLES
#+OPTIONS: ^:{}
#+OPTIONS: H:6
#+OPTIONS: toc:6
:END:
:LATEXHEADER:
#+LATEX_HEADER: \lstdefinelanguage{RDescr}
#+LATEX_HEADER: {
#+LATEX_HEADER:   morekeywords = {Package,Version,License,Description,Title,Author,Maintainer,
#+LATEX_HEADER:                   Type,
#+LATEX_HEADER:                   Copyright,Date,
#+LATEX_HEADER:                   Depends,Imports,Suggests,Enhances,LinkingTo,
#+LATEX_HEADER:                   SystemRequiremenets,URL,BugReports,
#+LATEX_HEADER:                   Priority,
#+LATEX_HEADER:                   Collate,LazyData,KeepSource,BytreCompile,ZipData,Biarch,
#+LATEX_HEADER:                   BuildVignettes, VignetteBuilder,
#+LATEX_HEADER:                   Citation,NeedsCompilation,OS_Type,Language},
#+LATEX_HEADER:   sensitive    = TRUE,
#+LATEX_HEADER:   morecomment  = [l]{:}
#+LATEX_HEADER: }

#+LATEX_HEADER: \usepackage{rotfloat}
#+LATEX_HEADER: \usepackage[usenames,dvipsnames,table]{xcolor}
#+LATEX_HEADER: \definecolor{light-gray}{gray}{0.9}
#+LATEX_HEADER: \lstset{%
#+LATEX_HEADER:     basicstyle=\ttfamily\footnotesize,       % the font that is used for the code
#+LATEX_HEADER:     tabsize=4,                       % sets default tabsize to 4 spaces
#+LATEX_HEADER:     numbers=left,                    % where to put the line numbers
#+LATEX_HEADER:     numberstyle=\tiny,               % line number font size
#+LATEX_HEADER:     stepnumber=0,                    % step between two line numbers
#+LATEX_HEADER:     breaklines=true,                 %!! don't break long lines of code
#+LATEX_HEADER:     showtabs=false,                  % show tabs within strings adding particular underscores
#+LATEX_HEADER:     showspaces=false,                % show spaces adding particular underscores
#+LATEX_HEADER:     showstringspaces=false,          % underline spaces within strings
#+LATEX_HEADER:     keywordstyle=\color{blue},
#+LATEX_HEADER:     identifierstyle=\color{black},
#+LATEX_HEADER:     stringstyle=\color{ForestGreen},
#+LATEX_HEADER:     commentstyle=\color{red},
#+LATEX_HEADER:     backgroundcolor=\color{light-gray},   % sets the background color
#+LATEX_HEADER:     columns=fullflexible,  
#+LATEX_HEADER:     basewidth={0.5em,0.4em}, 
#+LATEX_HEADER:     captionpos=b,                    % sets the caption position to `bottom'
#+LATEX_HEADER:     extendedchars=false              %!?? workaround for when the listed file is in UTF-8
#+LATEX_HEADER: }
#+LATEX_HEADER: \usepackage{svg}

#+LATEX: \listoffigures
:END:
:HTMLHEADER:
#+SETUPFILE: /Users/rainerkrug/.emacs.d/org-html-themes/setup/bigblow-pirilampo.setup
:END:
:BABEL:
#+PROPERTY: header-args :tangle-mode (identity #o444)
#+PROPERTY: header-args+ :tangle no
#+PROPERTY: header-args+ :mkdirp yes
#+PROPERTY: header-args+ :exports both
#+PROPERTY: header-args+ :comments both
#+PROPERTY: header-args+ :padline no
#+PROPERTY: header-args+ :eval no-export
:END:

* Introduction
Functions which I use from time to time and consider as useful.

* The Package
:PROPERTIES:
:header-args+: :eval never
:END:
** TODO makefile
:PROPERTIES:
:comments: no
:header-args+: :tangle no
:header-args+: :padline no
:header-args+: :no-expand TRUE
:header-args+: :comments no
:END:
For details of the implementation concerning tangling see [[notmuch:id:87ioo5x4td.fsf@gmail.com][Email from Eric Schulte: Re: {O} A simple org tangle an]]
*** Initial variables and macros
#+begin_src makefile
PROJECT = prodMixStands

EMACS       = emacs
BATCH_EMACS = $(EMACS) --batch -Q -l ./init.el

ROOTDIR = .

RDIR         = $(ROOTDIR)/R
DATADIR      = $(ROOTDIR)/data

INPUTDATADIR = $(ROOTDIR)/inst/inputdata
DOCSDIR      = $(ROOTDIR)/inst/documents

DBIFNDIR    = $(ROOTDIR)/DB_IFN
RAWDATADIR  = $(DBIFNDIR)/rawData
VECTDIR     = $(DBIFNDIR)/rdsVect
RASTDIR     = $(DBIFNDIR)/rdsRast

PROJ = Lamb1993
RASTCELL = 8km
RASTDEF = $(RASTCELL).$(PROJ)
#+end_src 
*** Target help 
#+begin_src makefile
help:
$(info )
$(info Defined targets)
$(info ============)
$(info make help           - show brief help)	
$(info make clean          - deletes files generated by tangling and export / compiling of project)
$(info make cleancache     - deletes cached data in ./cache)
$(info )
$(info Update input data Project)
$(info ===============)
$(info make update         - updates input files from input data and cleans results and cache )
$(info '                   ' by calling targets clean and cleancache )
$(info )
$(info Tangle Project)
$(info ===============)
$(info )
$(info export project)
$(info ===============)
$(info make html           - exports projrct to $(PROJECT).html)
#+end_src 
*** Target tangle 
#+begin_src makefile
tangle: prodMixStands.org
$(info ===============)
$(info Tangling project)
$(info Tangling not implemented yet)
$(info ===============)
#$(BATCH_EMACS) $(PROJECT).org --eval (mapc (lambda (file) (find-file (expand-file-name file "")) (org-babel-tangle-file) (kill-buffer)) ($(PROJECT).org))
#+end_src 
*** Target html 
#+begin_src makefile
html: prodMixStands.org
$(info ===============)
$(info Exporting to html)
$(info *** DOES NOT EXPORT PROPERLY ***)
$(info ===============)
$(BATCH_EMACS) $(PROJECT).org -f org-html-export-to-html
open $(PROJECT).html
#+end_src 
*** Target tex 
#+begin_src makefile
tex: 
$(info ===============)
$(info Exporting to tex not implemented yet)
$(info ===============)
$(BATCH_EMACS) $(PROJECT).org -f org-latex-export-to-latex
#+end_src
*** Target clean 
#+begin_src makefile
clean:
$(info ===============)
$(info Cleaning Project of generated files)
$(info ===============)
find $(ROOTDIR) ! -name '*.org*' ! -name '*.bib' ! -name '*.css' ! -name 'makefile' ! -name 'init.el' ! -name '.gitignore' -maxdepth 1 -type f -delete
$(RM) $(RDIR)/*
$(RM) $(DATADIR)/*
#+end_src
*** Target cleancache 
#+begin_src makefile
cleancache:
$(info ===============)
$(info Cleaning cached data)
$(info ===============)
$(RM) $(ROOTDIR)/cache/*
#+end_src

*** Target update
#+begin_src makefile
update: clean cleancache
$(info ===============)
$(info Updates input data)
$(info ===============)
$(RM) $(INPUTDATADIR)/*
cp -f $(VECTDIR)/tabplot.$(PROJ).rds $(VECTDIR)/tabtree.$(PROJ).rds $(INPUTDATADIR)/	
cp -f $(DBIFNDIR)/IFN.sqlite $(INPUTDATADIR)/	
cp -f $(DBIFNDIR)/DB_IFN.R $(DBIFNDIR)/meF_IFN.m $(DOCSDIR)/	
$(info Will need new execution of code to update the Analysis!)
#+end_src

** DESCRIPTION File
:PROPERTIES:
:header-args: :comments no
:header-args+: :tangle ./DESCRIPTION
:header-args+: :padline no
:header-args+: :no-expand TRUE
:header-args+: :comments no
:END:

#+begin_src RDescr
Package: myTols
Type: Package
Title: Some useful functions
Version: 0.0.1 
Date: 10.11.2014
Author: Rainer M. Krug
Maintainer: Rainer M Krug <Rainer@krugs.de>
Description: To Be added
License: GPL-3
LazyData: yes
Depends: 
#+end_src

** Define data (./data/)
** R functions (./R)
:PROPERTIES:
:header-args: :exports   code
:header-args+: :results   none
:END:
Some function definitions and setting up of the computing
environment.  The functions are in the ~./R/~ folder, while the data
has been stored in the ~./data/~ folder as an ~.rda~ file.
These can be put into a package later.
*** reinstallAll
:PROPERTIES:
:header-args+: :tangle ./R/reinstallAll.R
:END:
re-install all packages installed in ~.libPaths()[1]~
#+begin_src R 
reinstalAll <- function(
    lib.loc =  .libPaths()[1],
    type    = "source"
) {
    install.packages( 
        lib  = lib.loc,
        pkgs = as.data.frame(
            installed.packages(lib.loc),
            stringsAsFactors=FALSE
        )$Package,
        type = type
    )
}
#+end_src
